"""update task: fractional seconds for last_message_datetime

Revision ID: 5645ff0023eb
Revises: f30d60e75b8a
Create Date: 2022-02-10 20:06:04.527925

"""
from alembic import context, op
import sqlalchemy as sa
from sqlalchemy.dialects.mysql import DATETIME


# revision identifiers, used by Alembic.
revision = '5645ff0023eb'
down_revision = 'f30d60e75b8a'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    if context.get_x_argument(as_dictionary=True).get("sqlite", None):
        with op.batch_alter_table("task") as batch_op:
            batch_op.alter_column(
                "last_message_datetime",
                existing_type=sa.DateTime(),
                type_=DATETIME(fsp=6),
                existing_nullable=True,
            )
    else:
        op.alter_column(
            "task",
            "last_message_datetime",
            existing_type=sa.DateTime(),
            type_=DATETIME(fsp=6),
            existing_nullable=True,
        )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    if context.get_x_argument(as_dictionary=True).get("sqlite", None):
        with op.batch_alter_table("task") as batch_op:
            batch_op.alter_column(
                "last_message_datetime",
                existing_type=DATETIME(fsp=6),
                type_=sa.DateTime(),
                existing_nullable=True,
            )
    else:
        op.alter_column(
            "task",
            "last_message_datetime",
            existing_type=DATETIME(fsp=6),
            type_=sa.DateTime(),
            existing_nullable=True,
        )
    # ### end Alembic commands ###
